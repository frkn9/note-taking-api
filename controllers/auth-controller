const User = require('../models/User')
const { StatusCodes } = require('http-status-codes')
const {
    NotFoundError
} = require('../errors/errors-index')


const registerUser = async(req, res, next) => {
    const user = await User.create(req.body)
    res.status(StatusCodes.CREATED).json( {username: user.username, email: user.email  })
    
}

const getAllUsers = async (req, res) => {
    const users = await User.find( {} ).select('username email').select({_id:0})
    res.status(StatusCodes.OK).json( {users} )
}

const deleteUser = async(req, res) => {
    const userId = req.params.id
    const user = await User.findByIdAndDelete(userId)
    if(!user){
        throw new NotFoundError(`No user with id ${id}`)
    }
    res.status(StatusCodes.OK).send()
}

module.exports = {
    registerUser,
    getAllUsers,
    deleteUser,
}